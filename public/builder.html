	<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Map Builder</title>
	<link rel="stylesheet" href="builder.css">
</head>
<body>
<div id="app">
	<!-- Loading Overlay -->
	<div id="loading-overlay">
		<div class="spinner"></div>
		<div id="loading-text">Generating Thumbnails...</div>
	</div>
	
	<!-- Left Sidebar -->
	<div id="sidebar">
		<div id="sidebar-header">
			Map Builder Assets
		</div>
		<div id="asset-list">
			<div id="asset-load-area">
				<p style="color: #bdc3c7; font-size: 13px; margin-bottom: 15px;">Assets not loaded.</p>
				<button id="btnLoadAssets" class="info">Load Assets</button>
			</div>
		</div>
		
		<!-- Collapsible Controls Container -->
		<div id="controls-container">
			<div id="controls-header">
				Map Controls
			</div>
			<div id="controls-content">
				<div class="control-row">
					<button id="btnUndo" class="secondary" disabled>Undo</button>
					<button id="btnRedo" class="secondary" disabled>Redo</button>
				</div>
				
				<!-- Added Reset Camera Button -->
				<button id="btnResetCam" class="secondary" style="margin-bottom: 5px;">Reset Camera</button>
				
				<button id="btnSettings" class="info">Global Settings</button>
				<button id="btnSave">Save Map (JSON)</button>
				<button id="btnSaveAs" class="secondary">Save As...</button>
				<button id="btnLoad" class="secondary">Load Map</button>
				<button id="btnAddLight">Add Point Light</button>
				<button id="btnClearScene" class="danger">Clear Scene</button>
				<input type="file" id="fileInput" accept=".json">
			</div>
			
			<!-- Auto Save Status -->
			<div id="auto-save-container" style="padding: 10px; border-top: 1px solid #34495e; font-size: 12px; color: #bdc3c7; text-align: center; background: #1a252f;">
				<span id="auto-save-text">Not saved yet.</span>
				<a href="#" id="btnSaveNow" style="color: #3498db; text-decoration: none; margin-left: 5px;">Save Now</a>
			</div>
		</div>
	</div>
	
	<!-- Canvas -->
	<canvas id="renderCanvas"></canvas>
	
	<!-- Right Side Tree View -->
	<div id="tree-view">
		<div id="tree-header">
			<span>Scene Objects</span>
			<span id="tree-toggle-icon">â–¼</span>
		</div>
		<div id="tree-content">
			<!-- Tree items injected by JS -->
		</div>
	</div>
	
	<!-- Floating Property Panel -->
	<div id="properties-panel">
		<!-- Gizmo Toolbar -->
		<div class="prop-group" id="gizmo-toolbar" style="display: flex; gap: 5px; justify-content: center; border-bottom: 1px solid #34495e; padding-bottom: 10px; margin-bottom: 10px;">
			<button id="btnGizmoPos" class="info active" title="Move (G)">Move</button>
			<button id="btnGizmoRot" class="secondary" title="Rotate (R)">Rotate</button>
			<button id="btnGizmoScale" class="secondary" title="Scale (S)">Scale</button>
		</div>
		
		<!-- Lock Toggle (Global for single/multi) -->
		<div class="prop-group">
			<div class="prop-row" style="justify-content: flex-start;">
				<input type="checkbox" id="chkLock" style="width: auto; margin-right: 8px;">
				<label for="chkLock" style="margin: 0; cursor: pointer; color: white;">Lock Object(s)</label>
			</div>
		</div>
		
		<!-- Shared Properties (Color & Transforms) -->
		<div id="shared-props">
			<div class="prop-group">
				<label>Tint Color</label>
				<input type="color" id="propTint" value="#ffffff">
			</div>
			
			<div class="prop-group">
				<label>Position</label>
				<div class="prop-row compact">
					<div class="input-col"><span>X</span><input type="number" id="posX" step="0.1"></div>
					<div class="input-col"><span>Y</span><input type="number" id="posY" step="0.1"></div>
					<div class="input-col"><span>Z</span><input type="number" id="posZ" step="0.1"></div>
				</div>
			</div>
			
			<div class="prop-group">
				<label>Rotation (Degrees)</label>
				<div class="prop-row compact">
					<div class="input-col"><span>X</span><input type="number" id="rotX" step="15"></div>
					<div class="input-col"><span>Y</span><input type="number" id="rotY" step="15"></div>
					<div class="input-col"><span>Z</span><input type="number" id="rotZ" step="15"></div>
				</div>
			</div>
			
			<div class="prop-group">
				<label>Scale</label>
				<div class="prop-row compact">
					<div class="input-col"><span>X</span><input type="number" id="scaleX" step="0.1"></div>
					<div class="input-col"><span>Y</span><input type="number" id="scaleY" step="0.1"></div>
					<div class="input-col"><span>Z</span><input type="number" id="scaleZ" step="0.1"></div>
				</div>
			</div>
		</div>
		
		<!-- Single Object Specifics -->
		<div id="single-obj-props">
			<div class="prop-group">
				<label>Name</label>
				<input type="text" id="propName">
			</div>
		</div>
		
		<!-- Multi Object View -->
		<div id="multi-obj-props" style="display: none;">
			<div class="prop-group">
				<label>Alignment</label>
				
				<!-- X Axis -->
				<div class="align-grid">
					<span>X</span>
					<button id="btnAlignXMin" class="secondary" title="Align Left">Min</button>
					<button id="btnAlignXCenter" class="secondary" title="Align Center X">Mid</button>
					<button id="btnAlignXMax" class="secondary" title="Align Right">Max</button>
				</div>
				
				<!-- Y Axis -->
				<div class="align-grid">
					<span>Y</span>
					<button id="btnAlignYMin" class="secondary" title="Align Bottom">Bot</button>
					<button id="btnAlignYCenter" class="secondary" title="Align Center Y">Mid</button>
					<button id="btnAlignYMax" class="secondary" title="Align Top">Top</button>
				</div>
				
				<!-- Z Axis -->
				<div class="align-grid">
					<span>Z</span>
					<button id="btnAlignZMin" class="secondary" title="Align Back">Min</button>
					<button id="btnAlignZCenter" class="secondary" title="Align Center Z">Mid</button>
					<button id="btnAlignZMax" class="secondary" title="Align Front">Max</button>
				</div>
			</div>
			
			<!-- Spacing Group -->
			<div class="prop-group">
				<label>Space Side-by-Side</label>
				<div class="control-row">
					<button id="btnSnapX" class="secondary" title="Snap objects together on X axis">Snap X</button>
					<button id="btnSnapY" class="secondary" title="Snap objects together on Y axis">Snap Y</button>
					<button id="btnSnapZ" class="secondary" title="Snap objects together on Z axis">Snap Z</button>
				</div>
			</div>
			
			<!-- Grouping Control -->
			<div class="prop-group">
				<label>Grouping</label>
				<button id="btnCreateGroup" class="info">Group Selected Objects</button>
			</div>
			
			<div class="prop-group">
				<label>Selected Objects</label>
				<div id="multi-select-container"></div>
			</div>
		</div>
		
		<!-- Buttons (Global for selection) -->
		<button id="btnDuplicate" class="info" style="margin-bottom: 5px;">Duplicate</button>
		<button id="btnDeleteObj" class="danger">Delete Object(s)</button>
	</div>
	
	<!-- Global Settings Modal -->
	<div id="settingsModal" class="modal-overlay">
		<div class="modal-content">
			<div class="modal-header">Global Settings</div>
			
			<div class="control-group">
				<label>New Object Y-Offset:</label>
				<input type="number" id="settingYOffset" step="0.1" value="0">
			</div>
			
			<div class="control-group">
				<label>Grid Cell Size:</label>
				<input type="number" id="settingGridSize" step="0.5" min="0.5" value="2.5">
			</div>
			
			<div class="control-group">
				<label>Grid Line Color:</label>
				<input type="color" id="settingGridColor" value="#555555">
			</div>
			
			<div class="control-group">
				<label>Canvas Background Color:</label>
				<input type="color" id="settingBgColor" value="#2c3e50">
			</div>
			
			<div class="control-group" style="margin-top: 10px; border-top: 1px solid #34495e; padding-top: 10px;">
				<label style="color: #2ecc71;">Session:</label>
				<div class="control-row">
					<label><input type="checkbox" id="settingAutoSave" checked> Auto-Save Map (LocalStorage)</label>
				</div>
			</div>
			
			<div class="modal-footer">
				<button id="btnCancelSettings" class="secondary">Cancel</button>
				<button id="btnSaveSettings">Save & Apply</button>
			</div>
		</div>
	</div>
	
	<!-- Grid Creation Modal -->
	<div id="gridModal" class="modal-overlay">
		<div class="modal-content">
			<div class="modal-header">Add Object Grid</div>
			
			<div class="control-group">
				<label>Rows:</label>
				<input type="number" id="gridRows" value="3" min="1">
			</div>
			
			<div class="control-group">
				<label>Columns:</label>
				<input type="number" id="gridCols" value="3" min="1">
			</div>
			
			<div class="modal-footer">
				<button id="btnCancelGrid" class="secondary">Cancel</button>
				<button id="btnCreateGrid">Create Grid</button>
			</div>
		</div>
	</div>
	
	<!-- Save Map Modal -->
	<div id="saveMapModal" class="modal-overlay">
		<div class="modal-content">
			<div class="modal-header">Save Map</div>
			
			<div class="control-group">
				<label>Map Name:</label>
				<input type="text" id="saveMapName" value="new_map">
			</div>
			
			<div class="modal-footer">
				<button id="btnCancelSave" class="secondary">Cancel</button>
				<button id="btnConfirmSave">Save</button>
			</div>
		</div>
	</div>
	
	<!-- Custom Context Menu -->
	<div id="context-menu">
		<div class="ctx-item" id="ctx-add-grid">Add Grid of Objects...</div>
	</div>
</div>
</body>
</html>
