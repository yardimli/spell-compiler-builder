#TODO

#TODO 12
- add asset store, remove tint from assets


- create a new file to manage cameras called camera-manager.js, move existing camera code there.
- allow adding multiple cameras to the scene, allow user to drag, rotate the camera, in properties add fov settings for cameras besides position, direction and rotation.
- allow user to view scene from different cameras using a dropdown in the top menubar
- EditorCamera should not be saved as part of the scene, only user added cameras should be saved, and should be the default camera in the dropdown, EditorCamera can not be removed either.
- render cameras with a simple 3d representation including where it is looking on the scene so user can see where they are located

#TODO 13
- allow to reorder assets in the treeview with drag and drop to change rendering order
- allow to nest groups within other groups in the treeview

#TODO 14
- use llm to generate procedural scenes that can be run then edited by the user and saved

#TODO LATER AFTER TESTING CREAT OF SCENES
- allow user to edit asset colors for individual meshes inside a glb file, if there is a texture file allow to use it, or just use a color tint, show it in an modal for the selected asset where user can see the results.
- on the hemispheric light also show the direction in the mesh on the scene
- in updateGhostPosition() when snapping instead of only having 8 points to snap change it to 3d so each side will have 9 points (4 corners, 4 midpoints and center) so total 6 sides x 9 points = 54 points to snap from
- allow enabling disabling skybox (implement in global settings modal)
var createScene = function () {
    var scene = new BABYLON.Scene(engine);
    var camera = new BABYLON.ArcRotateCamera("Camera", -Math.PI / 2,  Math.PI / 2, 5, BABYLON.Vector3.Zero(), scene);
    camera.attachControl(canvas, true);

	var light = new BABYLON.HemisphericLight("hemiLight", new BABYLON.Vector3(-1, 1, 0), scene);
	light.diffuse = new BABYLON.Color3(1, 0, 0);

	// Skybox
	var skybox = BABYLON.MeshBuilder.CreateBox("skyBox", {size:1000.0}, scene);
	var skyboxMaterial = new BABYLON.StandardMaterial("skyBox", scene);
	skyboxMaterial.backFaceCulling = false;
	skyboxMaterial.reflectionTexture = new BABYLON.CubeTexture("textures/skybox", scene);
	skyboxMaterial.reflectionTexture.coordinatesMode = BABYLON.Texture.SKYBOX_MODE;
	skyboxMaterial.diffuseColor = new BABYLON.Color3(0, 0, 0);
	skyboxMaterial.specularColor = new BABYLON.Color3(0, 0, 0);
	skybox.material = skyboxMaterial;

    return scene;

};
export default createScene


#DONE

#TODO 1
- the scroll wheel is not working it should zoom in and out of the canvas
- right click should pan the canvas
- the magnetic lock should lock the sides of objects, not center it should not make objects overlap
- split index.js into the builder-scene.js and builder-ui.js
- add a cursor on the canvas clicking on the grid will select the update the selected cell
- remove the drag and drop functionality for adding objects to the canvas, instead clicking on an object should add it to the center of the selected cell
- double clicking on an object should make the camera center on that object and zoom in

#TODO 2
- make snapping to grid optional (toggle button in the UI)
- make snapping to other objects optional (toggle button in the UI)
- snapping should look at all corner combinations and snap the closest one and only choose the one that doesnt make objects overlap
- all added objects to the canvas should have a name property that can be edited
- add a property panel for selected objects, where user can edit position (x,y,z), rotation, scale (x and y)
- implement undo and redo functionality
- create a new js file for managing the objects
- create a new js file for the property panel UI

#TODO 3
- all file names start with category_name... group the files into collapsible panels with the category name
- in the asset-item for label remove the .glb extension and the first categoryname from the label.
- when giving the objects name use the full filename except the extension but add a _1 _2 etc. to make the names unique
in the grid make the current size 50% smaller for how each grid size is rendered

- bug: undo doesnt work properly after deleting an object or moving an object

#TODO 5

- make pan and zoom with mouse only work when ctrl key is pressed
- enable multi-selection of objects, shift key to be pressed to use mouse for multi-selection
- allow moving multiple selected objects at the same time
- allow deleting multiple selected objects at the same time
- when multiple objects are selected highlight all of the selected objects
- when multiple objects are selected in property panel show a list of all selected objects
- allow duplicating multiple selected objects at the same time (duplicate button in the property panel when multiple objects are selected)

#TODO 6

- when adding new objects if an object is already selected add the new object on top of the selected object
- allow user to lock existing objects so they cant be moved or deleted (in property panel add a lock toggle)
- allow user to select multiple objects and lock them all at once
- save current map to local storage so it persists between sessions (checkbox in global settings modal to enable/disable this feature, enabled by default)
- allow to add a grid of objects, when adding right click on the objects sidebar add an option to add a grid of objects (specify rows and columns), the objects should touch each other without gaps
- when multiple objects are selected in the properties menu add 3 button set X, Y and Z to same values
- make the add grid use html modal not alert inputs

#TODO 7
- BUG: when adding objects on top of another there is a visible gap between them.
- when multiple objects are select instead of x,y,z add 2 for each align to the min or max of each use the highest/lowest value of selected objects.
- add buttons to align tops, align bottoms of selected objects
- BUG: when pressing ctrl or alt make sure the window is in focus so the keypresses are detected properly and alt-tab doesnt trigger alt keypress in the app
- add color tint property to property panel for objects
- add x,y,x arrows above the selected asset on the canvas. to move the asset the user needs to drag one of the arrows. dont allow user to drag the object itself.
- when duplicating an object keep it closer to the original
- when duplicating an object the textures, scale and rotation doesnt duplicate they should be identical to the original.
- objects should cast shadows on each other not just the ground plane
- in property editor for both single and selected objects add three icons for drag (currently exist), scale (x,y,z) and rotate  (x,y,z), scale and rotate should show ui similar to the 3 arrows for drag, rotate should show circles the user can use the mouse to rotate for each dimension
- remove the auto snap to grid,objects feature
- when multiple elements are selected add buttons to space side by side in x,y,z so there wont be any gap in the direction the user choose between the objects
- when clicking on undo/redo reselect the current selected objects but verify that they exist after the undo.
- in the property panel make the position, rotation and scale inputs be side by side not stacked for each
- when multiple objects are selected for position, rotation, scale only allow user to edit in property panel for all selected objects similar to the way they are moved
- when multiple objects are selected allow user to change color for all in property panel
- make undo/redo work with keyboard shortcuts ctrl+z and ctrl+y

#TODO 8
- create a new js file for managing object groups called tree-view.js
- add a object tree view that can be turned collapsed or full height of the screen. it will use absolute positioning on the right side of the screen and show on top of the canvas when open. it will show all objects and groups in a hierarchical view.
- add object grouping functionality, allow user to group multiple selected objects into a single group (add group button in property panel when multiple objects are selected)
- only allow one level of grouping (no nested groups)
- groups are for management dont add any hierarchy to the scene itself
- clicking on an object or group in the tree view will select it in the canvas
- allow renaming groups in the tree view
- allow user to select multiple objects in the tree view using shift key
- when user clicks on a group name in the tree view it will select all objects inside that group on the tree view and the canvas
- allow deleting groups from tree view (deleting a group will not delete the objects inside just ungroup them)

BUG: deleting an asset breaks the tree view with error
- allow user to drag an asset on the tree view into a group to add it to that group
- allow user to drag an asset out of a group to ungroup it
- groups should be collapsible in the tree view
- allow selecting multiple groups
- disable text selection in the tree view when clicking and dragging to select multiple items as it is confusing

- redesign the sidebar so map controls are moved to a new menu bar on the top of the application and create a status bar at the bottom of the application both are always visible, map builder assets should be like scene objects and collapsible on the left side of the application

- locked items on the canvas should not be selectable from the canvas only treeview should select them
- in tree view show icon next to locked items
- make grid lines thinner

#TODO 9
- add asset objects folders functionality
- in assets there are now an objects subfolder which contains multiple folders each representing a category of objects
- in the assets sidebar add a dropdown at the top to select the asset object folder to show its contents
- update thumbnails generation to save thumbnails in cache folder under a subfolder with the name of the asset object folder
- when selected show the load assets button that will load the assets from the selected folder only and generate thumbnails for them if they dont exist
- BUG: when aligning objects with the buttons the scene updates but when i save and load the scene the object positions are not updated properly
- on the scene objects remember collapsed state between sessions using local storage
- on the scene remember last selected assets and reselect them on load
- allow user to select locked assets with shift+click
- merge the object inspector to be part of the scene objects sidebar on the right
- assets with colors when first added to the scene have colors but later when the scene is reloaded the colors are gone and they are all gray
- in color add reset button that will reset the color to null (default texture color)
-on the ui put name, object color and the reset button on the same row, the object color should be a square sized
- when adding a new asset, user should select it first from the left sidebar, the selected asset should be highlighted, then when clicking on the canvas it will add the selected asset to the clicked place on the grid. if another asset is already selected it should add it above the existing one as it is now. The selection should remain so subsequent clicks will add more of the same asset until another asset is selected from the sidebar or the selection is cleared (add a clear selection button on the top menubar it should both clear any objects selected on the scene and in the asset sidebar, esc key should do the same)
- when one or more objects are selected make the arrow keys move the selection on the x,z planes if the user press shift up/down arrow keys should move it on the y plane. on the top menubar add a small numeric input for cursor increment default is 0.05 with increments in 0.05
- when panning the camera with ctrl if user press ctrl+shift allow panning in the 3rd axis that it is not panning in

#TODO 10
- when adding a new asset to the scene show a ghost asset under the mouse that should snap to existing assets on all edges, if user clicks on top of the asset on the scene it should be placed above instead.
- when snapping it should check if the selected asset is the same file as the new one being added and if so it should rotate the new one to match the rotation of the existing one and snap accordingly.
- when snapping calculate the rotation and scale for the snapping points of both target and ghost align, currently it still calculates the snapping points as if it hadnt been rotated or scaled so the new asset isnt aligning properly with the target
- add shortcut so del key will delete assets same as the button
- on the scene objects make the height of the property inspector and tree view start with 50% each, allow user user to change the height with a horizontal splitter, amke it so even if the property inspector is not showing the tree view should not change size.
- change so every asset can be targeted for snapping to with every other asset with right click

- allow from sidebar treeview to hide/unhide assets and groups. hidden assets or groups should not be rendered.
- the snap side by side should have a margin setting
- in settings modal allow user to set minimum increment for position(downto 0.0001), and default position (downto 0.0001), same for rotation and scale, and cursor movement properties
- in the ui use same color for x,y,x buttons as the arrow colors when moving an asset

#TODO 11
currently dirLight along with shadowGenerator are initialized static on load, the app should check if localstorage or a file being loaded has a asset with "type": "light", and use that one to add the light and the shadowGenerator instead of defining them in init(), also if either localstorage or a file doesnt have it add the default DirectionalLight to the scene with the shadowgenerator
currently only one light gets shadowgenerator update the code so all lights have properties for intensity, direction and shadow generator checkbox in the property editor
- make DirectionalLight and ShadowGenerator load as part of file not on scene init

- add a new js file for managing lights called light-manager.js
- make light button open a dropdown with Pointlight, DirectionalLight, HemisphericLight
- add property panel for lights to adjust color diffuse and specular for all 3 types and groundColor for HemisphericLight
- keep the current property editors and add make sure that
- adjust location for Pointlight and DirectionalLight
- adjust direction for DirectionalLight and HemisphericLight
- show different simple 3d representations for each light type on the scene and a reprententation of direction for DirectionalLight and HemisphericLight
- also make sure a new scene have at least one HemisphericLight, same as the sun
- when moving the mouse in the statusbar show the current mouse position in world coordinates (x,y,z) based on the ground plane
